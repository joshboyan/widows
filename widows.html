<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widows JS</title>
    <link rel="stylesheet" href="css/app.css">
  </head>
  <body>
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Non inventore adipisci sunt nam explicabo corporis, consequatur fuga labore, error provident repellat officiis suscipit obcaecati, voluptate, a fugit repellendus! Tempore, expedita!</p>
    <p>consectetur adipisicing elit. Non inventore adipisci sunt nam explicabo corporis, consequatur fuga labore, error provident repellat officiis suscipit obcaecati, voluptate, a fugit repellendus! Tempore, expedita!</p>
    <p>Non inventore adipisci sunt nam explicabo corporis, consequatur fuga labore, error provident repellat officiis suscipit obcaecati, voluptate, a fugit repellendus! Tempore, expedita!</p>
    <p>Eat a dick you smelly pig!</p>
    <p>Coding is so much more fun than business homework!</p>
    <ul>
      <li>Do list items work as well?</li>
      <li>Dunno, do they?</li>
      <li>Shit if I know!</li>
    </ul>
    <blockquote>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Molestiae alias sed quis quae odio adipisci repudiandae, maiores vero nihil quia aspernatur, nesciunt quibusdam fugit velit eius nisi quaerat ea modi!</blockquote>
    <blockquote>consectetur adipisicing elit. Molestiae alias sed quis quae odio adipisci repudiandae, maiores vero nihil quia aspernatur, nesciunt quibusdam fugit velit eius nisi quaerat ea modi!</blockquote>
    <blockquote>Molestiae alias sed quis quae odio adipisci repudiandae, maiores vero nihil quia aspernatur, nesciunt quibusdam fugit velit eius nisi quaerat ea modi!</blockquote>
    <script>

    function widows() {
      //console.log(arguments);      
      //Array to hold all the text from inside the targeted tags
      var pageText = [];
      //Loop throght each of the HTML elements passed to the fution as arguments
      for(j = 0; j < arguments.length; j++) {
      //Clear array for each html elements text
      pageText = [];
      //Variable containing all the targeted tags
      var elements = document.body.getElementsByTagName(arguments[j]);
      console.log(arguments[j]);
      //Loop through each of the element
      for(i = 0; i < elements.length; i++) {
       var current = elements[i];
       // Check the element has no children && that it is not empty
        if(current.children.length === 0 && current.textContent.replace(/ |\n/g,'') !== '') {
           //Push the text from each tag to the storing array
           pageText.push(current.textContent);
        }
      }
      //console.log(pageText);
      //Loop through the text from each element
      var count = 1;
//This i variable needs to know where to start based on what tag we are at. 0 for the first element, 0 + firstElement.length for the second etc.
      for(i = 0; i < pageText.length; i++) {
      var tag = pageText[i];      
      //Split each element into a subarray of words
      tag = tag.split(' ');
      //console.log(tag);
      //Create an array with a nonbreakng space
      var widow = ['&nbsp;'];
      //console.log(widow);
      //Push last word from tag to after &nbsp;
      widow.push(tag.pop());
      //console.log(widow);
      //Create and array with a space
      var preWidow = [' '];
      //Push second to last word from tag to after the space
      preWidow.push(tag.pop());
      //console.log(preWidow);
      //Create string from arrays containing space/second to last word and &nbsp;/last word
      widow = preWidow.concat(widow).join('');
      //console.log(widow);
      //create string from the rest of the words in the tag
      tag = tag.join(' ');
      //console.log(tag);
      //Create string completed widowless string from substrings
      var merged = tag.concat(widow);
      //console.log(arguments[j]);
      //insert edited string back into DOM 
      console.log(arguments[j] + ':nth-of-type(' + count +')');    
      document.querySelector(arguments[j] + ':nth-of-type(' + count +')').innerHTML = merged;
      count++;
      //console.log(count);
      }
    }
  }

    widows(...['p', 'li', 'blockquote']);
    

    </script>
  </body>
</html>
